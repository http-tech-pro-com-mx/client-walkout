<div class="main-content">
  <app-loader *ngIf="loading"></app-loader>
  <div class="container-fluid" *ngIf="!loading">
    <div class="row">
      <div class="col-md-6">
        <select class="proyectos" [(ngModel)]="selectedProject" (change)="limpiarBusqueda()">
          <option data-tokens="proyecto.nombre" *ngFor="let proyecto of proyectos" [value]="proyecto.id_proyecto">{{ proyecto.nombre }}</option>
        </select>
      </div>
      <div class="col-md-6">
        <button type="button" class="btn btn-info" (click)="busquedaIp()">VER IP's</button>
      </div>
    </div>
    <div class="contenedor busqueda" *ngIf="busqueda">
      <div class="row">
        <div class="col-md-12">
          <br>
          <div class="form-group">
            <label for="buscar">FILTRAR:</label>
            <input type="text" class="form-control" id="buscar" placeholder="ESCRIBE AQUÍ PARA FILTRAR" [(ngModel)]="filtrar" [ngModelOptions]="{standalone: true}">
          </div>
        </div>
      </div>
      <div class="row" *ngIf="permisos.crear">
        <a type="button" class="btn btn-primary btn-circle btn-xl" [routerLink]="'crear/'+selectedProject">
          <i class="fa fa-plus"></i>
        </a>
      </div>
      <div class="row">
        <div class="col-md-12">
          <div class="card">
            <div class="header">
              <h4 class="title">LISTADO DE IP</h4>
              <p class="category">ESTATUS:
                <label>
                  <img src="assets/img/walking.png" class="icon-description"> CAMINANDO</label>
                <label>
                  <img src="assets/img/qc.png" class="icon-description"> REVISIÓN QC</label>
                <label>
                  <img src="assets/img/qcOk.png" class="icon-description"> VALIDADO QC</label>
                <label>
                  <img src="assets/img/shared.png" class="icon-description"> SHAREDPOINT</label>
              </p>
            </div>
            <div class="content table-responsive table-full-width">
              <table class="table table-hover table-striped">
                <thead>
                  <tr>
                    <th>IP</th>
                    <th>FECHA LEVANTAMIENTO</th>
                    <th>PIES</th>
                    <th>KM</th>
                    <th>UBICACIÓN</th>
                    <th>QC</th>
                    <th>PARTICIPANTES</th>
                    <th class="text-center" *ngIf="permisos.editar">DETALLE</th>
                    <th class="text-center" *ngIf="permisos.eliminar">ELIMINAR</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngIf="ips.length == 0">
                    <td class="text-center" colspan="9">SIN REGISTROS</td>
                  </tr>
                  <tr *ngFor="let ip of ips | searchIP: filtrar" class="tr-puntero-color">
                    <td>{{ ip.ip }}</td>
                    <td>{{ ip.fecha_levantamiento | date: 'fullDate' }}</td>
                    <td>{{ ip.pies }}</td>
                    <td>{{ ip.pies | ftKm }}</td>
                    <td>{{ip.ubicacion}}</td>
                    <td>
                      <a href="javascript:void(0);">
                        <img src="assets/img/walking.png" class="icon-status" alt="Caminando" *ngIf="ip.qc == 0 " (click)="openModalEstatus('0', ip.ip)">
                        <img src="assets/img/qc.png" class="icon-status" alt="Revisando" *ngIf="ip.qc == 1 " (click)="openModalEstatus('1', ip.ip)">
                        <img src="assets/img/qcOk.png" class="icon-status" alt="QC Terminado" *ngIf="ip.qc == 3 " (click)="openModalEstatus('2', ip.ip)">
                        <img src="assets/img/shared.png" class="icon-status" alt="SharePoint" *ngIf="ip.qc == 2 " (click)="openModalEstatus('3', ip.ip)">
                      </a>
                    </td>
                    <td>
                      <div class="dropdown">
                        <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu" data-toggle="dropdown" aria-expanded="true">
                          Walkers
                          <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu">
                          <li role="presentation" *ngFor="let p of ip.participantes">
                            <a role="menuitem" tabindex="-1" href="javascript:void(0);">{{ p }}</a>
                          </li>
                        </ul>
                      </div>
                    </td>
                    <td class="text-center">
                      <button class="btn btn-info" [routerLink]="'editar/'+ip.id_ip" *ngIf="permisos.editar">DETALLE</button>
                    </td>
                    <td class="text-center">
                      <button class="btn btn-danger" (click)="eliminar(ip)" *ngIf="permisos.eliminar">ELIMINAR</button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="footer">
              <div class="container text-center">
                <ul class="pagination">
                  <li class="disabled">
                    <a href="javascript:void(0);">&laquo;</a>
                  </li>
                  <li class="active">
                    <a href="javascript:void(0);">1</a>
                  </li>
                  <li>
                    <a href="javascript:void(0);">&raquo;</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>